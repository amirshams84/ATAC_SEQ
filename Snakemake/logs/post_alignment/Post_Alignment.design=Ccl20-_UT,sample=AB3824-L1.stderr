Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 30
Rules claiming more threads will be scaled down.
Unlimited resources: mem_mb
Job counts:
	count	jobs
	1	Post_Alignment
	1

[Fri May 24 07:06:52 2019]
Job 0: Post_Alignment: Ccl20-_UT|AB3824-L1

[-] Unloading samtools 1.9  ... 
[+] Loading samtools 1.9  ... 
[+] Loading bedtools  2.27.1 
[+] Loading deeptools  3.1.3 
[+] Loading fastqc  0.11.8 
[+] Loading qualimap  2.2.1  on cn2050 
[+] Loading gcc  7.3.0  ... 
[+] Loading GSL 2.4 for GCC 7.2.0 ... 
[-] Unloading gcc  7.3.0  ... 
[+] Loading gcc  7.3.0  ... 
[+] Loading openmpi 3.0.2  for GCC 7.3.0 
[+] Loading ImageMagick  7.0.8  on cn2050 
[+] Loading HDF5  1.10.4 
[+] Loading pandoc  2.1.1  on cn2050 
[+] Loading R 3.5.2 
[+] Loading ucsc 373 on cn2050 
[-] Unloading gcc  7.3.0  ... 
[-] Unloading GSL 2.4 for GCC 7.2.0 ... 
[-] Unloading openmpi 3.0.2  for GCC 7.3.0 
[-] Unloading ImageMagick  7.0.8  on cn2050 
[-] Unloading HDF5  1.10.4 
[-] Unloading pandoc  2.1.1  on cn2050 
[-] Unloading R 3.5.2 
[+] Loading gcc  7.3.0  ... 
[+] Loading GSL 2.4 for GCC 7.2.0 ... 
[-] Unloading gcc  7.3.0  ... 
[+] Loading gcc  7.3.0  ... 
[+] Loading openmpi 3.0.2  for GCC 7.3.0 
[+] Loading ImageMagick  7.0.8  on cn2050 
[+] Loading HDF5  1.10.4 
[+] Loading pandoc  2.1.1  on cn2050 
[+] Loading R 3.5.2 
###################################- COMMANDLINE -############################
samtools/1.9
bedtools/2.27.1
deeptools/3.1.3
fastqc/0.11.8
qualimap/2.2.1
ucsc/373
#
Description:
Filtering bam file, correctGC Bias, drop short alignment
#
INPUT1: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3824-L1.bam
INPUT2: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3824-L1.bam.bai
#
OUTPUT1: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam
OUTPUT2: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam.bai
OUTPUT3: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bed.gz
OUTPUT4: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bed.gz.tbi
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
samtools view --threads 30 -h -F 1804 -f 2 -q 30 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3824-L1.bam | awk 'BEGIN{OFS=FS}{if ( $3 != "chrUn" && $3 != "chrEBV" && $3 !~ /chrUn/ && $3 !~ /random/ ) print $0}' | samtools view --threads 30 -Shb - > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.mapped.dupfilt.chrfilt.bam
#
bedtools intersect -v -abam /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.mapped.dupfilt.chrfilt.bam -b <(zcat -f ./Script/mm10.blacklist.bed.gz ) > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.mapped.dupfilt.chrfilt.blkfilt.bam
#
samtools sort --threads 30 -O bam /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.mapped.dupfilt.chrfilt.blkfilt.bam -o /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam
#
samtools index -@ 30 -b /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam
#
rm -rf /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.mapped.dupfilt.chrfilt.bam /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.mapped.dupfilt.chrfilt.blkfilt.bam
#
bedtools bamtobed -i /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bed.gz.tmp
#
LC_COLLATE=C sort -k1,1 -k2,2n /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bed.gz.tmp > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bed.gz.sorted
#
bgzip -c /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bed.gz.sorted > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bed.gz
#
bedToBigBed /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bed.gz.sorted /fdb/atac_dnase_pipelines/mm10/mm10.chrom.sizes /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bb
#
tabix -f -p bed /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bed.gz
#
rm -rf /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bed.gz.tmp /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bed.gz.sorted
#
samtools flagstat --threads 30 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/report/post_alignment/AB3824-L1.processed.samtools.txt
#
bamCoverage --bam /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam --outFileName /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bigwig --binSize 5 --normalizeUsing RPGC --extendReads 150 --outFileFormat bigwig --numberOfProcessors 30 --effectiveGenomeSize 2150570000
#
fastqc -o /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/report/post_alignment -f bam --threads 30 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam
#
qualimap bamqc -bam /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam -nt 30 --genome-gc-distr MOUSE - mm10 -hm 3 -nr 100 -nw 400 -outformat HTML --skip-dup-mode 1 --java-mem-size=10G -outdir /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/report/post_alignment/AB3824-L1_processed_qualimap
#
python ./Python_Script/bamQC.py --infile /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam --outfile /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/report/post_alignment/AB3824-L1_PBC.txt --cores 30
#
Rscript ./R_Script/run_spp_nodups.R -c=/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam -odir=/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/report/post_alignment/ -savp > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/report/post_alignment/AB3824-L1_processed_spp.txt
#
EXECUTING....
#
[bam_sort_core] merging from 0 files and 30 in-memory blocks...
pass1 - making usageList (22 chroms): 9192 millis
pass2 - checking and writing primary data (39509256 records, 6 fields): 140635 millis
normalization: 1x (effective genome size 2150570000)
bamFilesList: ['/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/post_alignment/AB3824-L1.processed.bam']
binLength: 5
numberOfSamples: None
blackListFileName: None
defaultFragmentLength: 150
numberOfProcessors: 30
verbose: False
region: None
bedFile: None
minMappingQuality: None
ignoreDuplicates: False
chrsToSkip: []
stepSize: 5
center_read: False
samFlag_include: None
samFlag_exclude: None
minFragmentLength: 0
maxFragmentLength: 0
zerosToNans: False
smoothLength: None
save_data: False
out_file_for_raw_data: None
maxPairedFragmentLength: 600
Started analysis of AB3824-L1.processed.bam
Approx 5% complete for AB3824-L1.processed.bam
Approx 10% complete for AB3824-L1.processed.bam
Approx 15% complete for AB3824-L1.processed.bam
Approx 20% complete for AB3824-L1.processed.bam
Approx 25% complete for AB3824-L1.processed.bam
Approx 30% complete for AB3824-L1.processed.bam
Approx 35% complete for AB3824-L1.processed.bam
Approx 40% complete for AB3824-L1.processed.bam
Approx 45% complete for AB3824-L1.processed.bam
Approx 50% complete for AB3824-L1.processed.bam
Approx 55% complete for AB3824-L1.processed.bam
Approx 60% complete for AB3824-L1.processed.bam
Approx 65% complete for AB3824-L1.processed.bam
Approx 70% complete for AB3824-L1.processed.bam
Approx 75% complete for AB3824-L1.processed.bam
Approx 80% complete for AB3824-L1.processed.bam
Approx 85% complete for AB3824-L1.processed.bam
Approx 90% complete for AB3824-L1.processed.bam
Approx 95% complete for AB3824-L1.processed.bam
Approx 100% complete for AB3824-L1.processed.bam
Java HotSpot(TM) 64-Bit Server VM warning: Ignoring option MaxPermSize; support was removed in 8.0
[+] Loading python 2.7  ... 
[-] Unloading python 2.7  ... 
[+] Loading snakemake  5.4.4 
[+] Loading java 12.0.1  ... 
[+] Loading samtools 1.9  ... 
[+] Loading bedtools  2.27.1 
[+] Loading deeptools  3.1.3 
[+] Loading fastqc  0.11.8 
[+] Loading qualimap  2.2.1  on cn2050 
[+] Loading ucsc 373 on cn2050 
[+] Loading GSL 2.4 for GCC 7.2.0 ... 
[+] Loading gcc  7.3.0  ... 
[+] Loading openmpi 3.0.2  for GCC 7.3.0 
[+] Loading ImageMagick  7.0.8  on cn2050 
[+] Loading HDF5  1.10.4 
[+] Loading pandoc  2.1.1  on cn2050 
[+] Loading R 3.5.2 
Loading required package: Rcpp
#
DONE!!!!
#
ELAPSED TIME: 4559 seconds
------------------------------------------------------------------------------
[Fri May 24 08:22:56 2019]
Finished job 0.
1 of 1 steps (100%) done
