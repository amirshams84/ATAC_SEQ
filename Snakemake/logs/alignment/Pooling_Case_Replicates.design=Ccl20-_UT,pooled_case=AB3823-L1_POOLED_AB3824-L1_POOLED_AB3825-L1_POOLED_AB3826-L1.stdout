###################################- COMMANDLINE -############################
bowtie/2-2.3.5
samtools/1.9
picard/2.18.27
fastqc/0.11.8
qualimap/2.2.1
Merging Biological replicates bam files into single pooled sample, sort mark duplicates, and index
#
INPUT1:: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1.bam
INPUT2:: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3824-L1.bam
INPUT3:: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3825-L1.bam
INPUT4:: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3826-L1.bam
#
OUTPUT1: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam
OUTPUT2: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam.bai
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
samtools merge --threads 30 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam.unsorted /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1.bam /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3824-L1.bam /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3825-L1.bam /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3826-L1.bam
#
samtools sort --threads 30 -m 2G -O bam /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam.unsorted -o /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam.sorted
#
java -Xms10000M -Xmx10000M -XX:ParallelGCThreads=30 -jar /usr/local/apps/picard/2.18.27/picard.jar MarkDuplicates INPUT=/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam.sorted OUTPUT=/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam TMP_DIR=/lscratch/27172317 METRICS_FILE=/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/report/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.picard.txt VALIDATION_STRINGENCY=LENIENT ASSUME_SORT_ORDER=coordinate REMOVE_DUPLICATES=false
#
samtools index -@ 30 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam
#
rm -rf /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam.unsorted
#
samtools flagstat --threads 30 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/report/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.samtools.txt
#
fastqc -o /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/report/alignment -f bam --threads 30 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam
#
qualimap bamqc -bam /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam -nt 30 --genome-gc-distr MOUSE - mm10 -hm 3 -nr 100 -nw 400 -outformat HTML --skip-dup-mode 1 --java-mem-size=10G -outdir /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/report/alignment/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1_qualimap
#
EXECUTING....
#
Analysis complete for AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.bam
Java memory size is set to 10G
Launching application...

QualiMap v.2.2.1
Built on 2016-10-03 18:14

Selected tool: bamqc
Available memory (Mb): 37
Max memory (Mb): 10737
Starting bam qc....
Loading sam header...
Loading locator...
Loading reference...
Number of windows: 400, effective number of windows: 421
Chunk of reads size: 100
Number of threads: 30
Processed 50 out of 421 windows...
Processed 100 out of 421 windows...
Processed 150 out of 421 windows...
Processed 200 out of 421 windows...
Processed 250 out of 421 windows...
Processed 300 out of 421 windows...
Processed 350 out of 421 windows...
Processed 400 out of 421 windows...
Total processed windows:421
Number of reads: 745525857
Number of valid reads: 733866887
Number of correct strand reads:0

Inside of regions...
Num mapped reads: 733866887
Num mapped first of pair: 368099346
Num mapped second of pair: 365767541
Num singletons: 3678462
Time taken to analyze reads: 2271
Computing descriptors...
numberOfMappedBases: 46775427366
referenceSize: 2725537669
numberOfSequencedBases: 46689659378
numberOfAs: 13837076076
Computing per chromosome statistics...
Computing histograms...
Overall analysis time: 2481
end of bam qc
Computing report...
Writing HTML report...
HTML report created successfully

Finished
#
DONE!!!!
#
ELAPSED TIME: 32826 seconds
------------------------------------------------------------------------------
