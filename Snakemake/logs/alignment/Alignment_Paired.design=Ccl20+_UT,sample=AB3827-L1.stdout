###################################- COMMANDLINE -############################
bowtie/2-2.3.5
samtools/1.9
picard/2.18.27
fastqc/0.11.8
qualimap/2.2.1
Alignment
#
INPUT1: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/pre_process/AB3827-L1.R1.processed.fastq
INPUT2: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/pre_process/AB3827-L1.R2.processed.fastq
#
OUTPUT1: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam
OUTPUT2: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam.bai
OUTPUT3: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/report/alignment/AB3827-L1.alignment.txt
OUTPUT4: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/report/alignment/AB3827-L1.picard.txt
OUTPUT5: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/report/alignment/AB3827-L1.samtools.txt
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
bowtie2 -k 10 --mm --local -X 2000 --threads 30 -x /fdb/igenomes/Mus_musculus/UCSC/mm10/Sequence/Bowtie2Index/genome -1 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/pre_process/AB3827-L1.R1.processed.fastq -2 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/pre_process/AB3827-L1.R2.processed.fastq 2> /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/report/alignment/AB3827-L1.alignment.txt | samtools sort --threads 30 -m 2G -O bam -T /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1 -o /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam.tmp - 
#
java -Xms10000M -Xmx10000M -XX:ParallelGCThreads=30 -jar /usr/local/apps/picard/2.18.27/picard.jar MarkDuplicates INPUT=/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam.tmp OUTPUT=/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam TMP_DIR=/lscratch/27137788 METRICS_FILE=/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/report/alignment/AB3827-L1.picard.txt VALIDATION_STRINGENCY=LENIENT ASSUME_SORT_ORDER=coordinate REMOVE_DUPLICATES=false
#
samtools index -@ 30 -b /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam
#
samtools flagstat --threads 30 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/report/alignment/AB3827-L1.samtools.txt
#
rm -rf /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam.tmp
#
fastqc -o /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/report/alignment -f bam --threads 30 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam
#
qualimap bamqc -bam /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam -nt 30 --genome-gc-distr MOUSE - mm10 -hm 3 -nr 100 -nw 400 -outformat HTML --skip-dup-mode 1 --java-mem-size=10G -outdir /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/report/alignment/AB3827-L1_qualimap
#
python ./Python_Script/bamChipQC.py --infile /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam --outfile /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/report/alignment/AB3827-L1_PBC.txt --cores 30
#
EXECUTING....
#
Analysis complete for AB3827-L1.bam
Java memory size is set to 10G
Launching application...

QualiMap v.2.2.1
Built on 2016-10-03 18:14

Selected tool: bamqc
Available memory (Mb): 37
Max memory (Mb): 10737
Starting bam qc....
Loading sam header...
Loading locator...
Loading reference...
Number of windows: 400, effective number of windows: 421
Chunk of reads size: 100
Number of threads: 30
Processed 50 out of 421 windows...
Processed 100 out of 421 windows...
Processed 150 out of 421 windows...
Processed 200 out of 421 windows...
Processed 250 out of 421 windows...
Processed 300 out of 421 windows...
Processed 350 out of 421 windows...
Processed 400 out of 421 windows...
Total processed windows:421
Number of reads: 204047291
Number of valid reads: 201776452
Number of correct strand reads:0

Inside of regions...
Num mapped reads: 201776452
Num mapped first of pair: 101088132
Num mapped second of pair: 100688320
Num singletons: 719766
Time taken to analyze reads: 633
Computing descriptors...
numberOfMappedBases: 13663099558
referenceSize: 2725537669
numberOfSequencedBases: 13645740783
numberOfAs: 4033464186
Computing per chromosome statistics...
Computing histograms...
Overall analysis time: 682
end of bam qc
Computing report...
Writing HTML report...
HTML report created successfully

Finished
Configured logger 'root' using pararead v0.5.0
Registering input file: '/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/alignment/AB3827-L1.bam'
Temporary files will be stored in: '/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/report/alignment/tmp_AB3827-L1_RG2MmA'
Processing with 30 cores...
[Name: chrY; Size: 91744698]
[Name: chrX; Size: 171031299]
[Name: chr13; Size: 120421639]
[Name: chr12; Size: 120129022]
[Name: chr11; Size: 122082543]
[Name: chr10; Size: 130694993]
[Name: chr17; Size: 94987271]
[Name: chr16; Size: 98207768]
[Name: chr15; Size: 104043685]
[Name: chr14; Size: 124902244]
[Name: chr19; Size: 61431566]
[Name: chr18; Size: 90702639]
[Name: chrM; Size: 16299]
[Name: chr7; Size: 145441459]
[Name: chr6; Size: 149736546]
[Name: chr5; Size: 151834684]
[Name: chr4; Size: 156508116]
[Name: chr3; Size: 160039680]
[Name: chr2; Size: 182113224]
[Name: chr1; Size: 195471971]
[Name: chr9; Size: 124595110]
[Name: chr8; Size: 129401213]
Discarding 0 chunk(s) of reads: []
Keeping 22 chunk(s) of reads: ['chrY', 'chrX', 'chr13', 'chr12', 'chr11', 'chr10', 'chr17', 'chr16', 'chr15', 'chr14', 'chr19', 'chr18', 'chrM', 'chr7', 'chr6', 'chr5', 'chr4', 'chr3', 'chr2', 'chr1', 'chr9', 'chr8']
Reduce step (merge files)...
Merging 22 files into output file: '/data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20+_UT/report/alignment/AB3827-L1_PBC.txt'
#
DONE!!!!
#
ELAPSED TIME: 12948 seconds
------------------------------------------------------------------------------
