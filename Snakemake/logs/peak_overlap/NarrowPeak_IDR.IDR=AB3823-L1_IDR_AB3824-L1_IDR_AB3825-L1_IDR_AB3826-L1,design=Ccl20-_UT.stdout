###################################- COMMANDLINE -############################
module load macs/2.1.2 || exit 1
module load samtools/1.9 || exit 1
module load bedtools/2.27.1 || exit 1
module load deeptools/3.1.3 || exit 1
module load ucsc/373 || exit 1
module load idr/2.0.3
#
Description:
Peak IDR Narrow
#
INPUT1: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1.narrowPeak.gz
INPUT2: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3824-L1.narrowPeak.gz
INPUT3: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.narrowPeak.gz
#
OUTPUT1: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz
OUTPUT2: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.tbi
OUTPUT3: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bb
OUTPUT4: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg
OUTPUT4: /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bigwig
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
idr --samples /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1.narrowPeak.gz /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3824-L1.narrowPeak.gz --peak-list /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_POOLED_AB3824-L1_POOLED_AB3825-L1_POOLED_AB3826-L1.narrowPeak.gz --input-file-type narrowPeak --output-file-type narrowPeak --rank signal.value --soft-idr-threshold 0.1 --plot --use-best-multisummit-IDR --input-file-type narrowPeak --peak-merge-method sum --output-file /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.tmp --max-iter 10000 --verbose
#
mv /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.tmp.png /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/report/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1_IDR.png
#
awk 'BEGIN{OFS="\t"} {$4="AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.macs2_narrowPeak_"NR} {if ($2<0) $2=0; print $1,$2,$3,$4,$5,$6,$7,$8,$9,$10}' /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.tmp | sort | uniq | LC_COLLATE=C sort -k1,1 -k2,2n > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.edited
#
bgzip -c /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.edited > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz
#
tabix -f -p bed /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz
#
awk 'BEGIN{FS="\t";OFS="\t"} {if ($5>1000) $5=1000; print $0}' /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.edited > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.fix
#
bedToBigBed -as=./Script/bigNarrowPeak.as -type=bed6+4 /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.fix /fdb/atac_dnase_pipelines/mm10/mm10.chrom.sizes /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bb
#
awk 'BEGIN{OFS="\t"} {printf "%s\t%d\t%d\t%2.3f\n", $1,$2,$3,$5}' /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.edited > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg.tmp
#
cat /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg.tmp | sort -u -k1,1 -k2,2 -k3,3 -s > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg.uniq
#
slopBed -i /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg.uniq -g /fdb/atac_dnase_pipelines/mm10/mm10.chrom.sizes -b 0 | bedClip stdin /fdb/atac_dnase_pipelines/mm10/mm10.chrom.sizes /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg.edited
#
LC_COLLATE=C sort -k1,1 -k2,2n /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg.edited > /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg
#
bedGraphToBigWig /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg /fdb/atac_dnase_pipelines/mm10/mm10.chrom.sizes /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bigwig
if [ -f /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bigwig ]; then
	rm -rf /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.tmp
	rm -rf /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.edited
	rm -rf /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.gz.fix
	rm -rf /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg.tmp
	rm -rf /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg.uniq
	rm -rf /data/shamsaddinisha/jfarber-20160119-P1/spsingh-20190308-E1/spsingh-20190521-D1/mm10/Ccl20-_UT/peak_calling/narrowpeak/AB3823-L1_IDR_AB3824-L1_IDR_AB3825-L1_IDR_AB3826-L1.narrowPeak.bdg.edited
fi
#
EXECUTING....
#
DONE!!!!
ELAPSED TIME: 92 seconds
----------------------------------------------------------------------------
